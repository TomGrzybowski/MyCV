<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV Tomasz Grzybowski</title>

    <link rel="stylesheet" href="./css/style.css" />

</head>

<body>
    <header class="header">
        <div class="container">
            <div class="header__image-container">
                <img class="header__img" src="./assets/me-1200.jpg" srcset="
                    ./assets/me-1200.jpg 1200w,
                    ./assets/me-800.jpg 800w,
                    ./assets/me-400.jpg 400w,
                    ./assets/me-200.jpg 200w
                    " sizes="1200px" alt="Profile picture" width="140" />
            </div>
            <h1 class="header__title">
                Tomasz Grzybowski - CV
            </h1>
            <svg class="header__burger" width="36" height="36" fill="currentColor" viewBox="0 0 20 20"
                xmlns="http://www.w3.org/2000/svg">
                <path fill-rule="evenodd"
                    d="M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z"
                    clip-rule="evenodd"></path>
            </svg>
            <div class="header__nav">
                <ul class="header__nav_list">
                    <li class="header__nav_list_item"> <a href="./index.html">CV</a> </li>
                    <li class="header__nav_list_item"> <a class="current_page"href="./MyGame.html">MyGame</a></li>
                </ul>
            </div>
    
        </div>
    </header>

    <main class="my_game_main">

        <section class="defuser">
            <div class="container">
               <form name="game_settings" autocomplete="off" class="defuser__form">
                    <label for="defuser__rows">Rows:</label>
                    <input type="number" id="defuser__rows" name="defuser__rows" placeholder="10" value = "5" min="5" max="20"/>
                    
                    <label for="defuser__cols">Columns:</label>
                    <input type="number" id="defuser__cols" name="defuser__cols" placeholder="10" value = "5" min="5" max="20"/>
                    
                    <label for="defuser__bombs">Bombs:</label>
                    <input type="number" id="defuser__bombs" name="defuser__bombs" placeholder="10" value = "5" min="5" max="20"/>

                    <button type="button" class="defuser__play" id="defuser__play">PLAY</button>
                </form>

               <div class="defuser__game">
               </div>
                
                
                
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <h2 class="footer__header">Contact</h2>
            <ul class="footer__list">
                <li>
                    <a class="footer__link" href="tel:+48534014034">
                        <svg class="footer__icon" height="24" width="24">
                            <use href="./assets/symbol-defs.svg#icon-mobile"></use>
                        </svg>
                        +48 534 014 034
                    </a>
                </li>
                <li>
                    <a class="footer__link" href="mailto:t.grzybowski94@gmail.com">
                        <svg class="footer__icon" height="24" width="24">
                            <use href="./assets/symbol-defs.svg#icon-envelope"></use>
                        </svg>
                        t.grzybowski94@gmail.com
                    </a>
                </li>
                <li>
                    <a class="footer__link" href="./index.html">
                        <svg class="footer__icon" height="24" width="24">
                            <use href="./assets/symbol-defs.svg#icon-location"></use>
                        </svg>
                        Wroc≈Çaw, Poland
                    </a>
                </li>
                <li>
                    <a class="footer__link" href="https://github.com/TomGrzybowski?tab=repositories" target="_blank">
                        <svg class="footer__icon" height="24" width="24">
                            <use href="./assets/symbol-defs.svg#icon-github"></use>
                        </svg>
                        Github link
                    </a>
                </li>
                <li>
                    <a class="footer__link" href="https://www.linkedin.com/in/tomasz-grzybowski-2075ba158/"
                        target="_blank">
                        <svg class="footer__icon" height="24" width="24">
                            <use href="./assets/symbol-defs.svg#icon-li"></use>
                        </svg>
                        LinkedIn
                    </a>
                </li>
            </ul>
        </div>
    </footer>


    <script>

        const game = document.querySelector(".defuser__game") //this is the main gameplay window
        const inputs = document.querySelectorAll("input")
        let rows = document.querySelector("#defuser__rows").value //check for input how many rows
        let cols = document.querySelector("#defuser__cols").value //check for input how many cols
        let bombsAmount = document.querySelector("#defuser__bombs").value //check for input how many cols
        const selectRows = document.querySelectorAll(".defuser__row") //selects all created rows
        const playButton = document.querySelector("#defuser__play") //Select PLAY button
        const hiders = document.querySelectorAll(".unrevealed")

        inputs.forEach( input => {  //add event listeners to inputs
            input.addEventListener("change", handleUpdate)
        })

        playButton.addEventListener("click", setup) //add event listener to play button
                
        function hide() {
            this.classList.add("is-hidden")
        }

        function handleUpdate(){
            rows = document.querySelector("#defuser__rows").value
            cols = document.querySelector("#defuser__cols").value
            bombsAmount = document.querySelector("#defuser__bombs").value
        }
        
        function createGrid() {
            for (let i = 1; i <= rows; i++){ // Create rows loop
                const rowDiv = document.createElement("div") 
                rowDiv.classList.add("defuser__row") //add universal class
                rowDiv.classList.add("row-" + i) //add numered class
                game.append(rowDiv)

                for (let ii = 1; ii <= cols; ii++) { //Create cells within rows
                    const cellDiv = document.createElement("div")
                    cellDiv.classList.add("defuser__cell") //add universal class
                    cellDiv.classList.add("col-" + ii) //add numered class

                    rowDiv.append(cellDiv) //create the cell
                    
                    const span = document.createElement("span") //create a content element
                    span.classList.add("defuser__cell_content") //add universal class

                    cellDiv.append(span)

                    const hiderDiv = document.createElement("div") //create a hider
                    hiderDiv.classList.add("unrevealed") //add universal class
                    hiderDiv.addEventListener("click", hide) //make the cells unhidable
                    hiderDiv.addEventListener("contextmenu", (e) => { //code rightclick (add flag)
                        e.preventDefault();
                        hiderDiv.textContent = "F"; //REPLCAE WITH ICON
                    }) //make the cells unhidable

                    cellDiv.append(hiderDiv) //add hidder
                }
            }
        }

        function insertBombs() {

            const bombs = new Set()

            //TODO BELOW LINE
            while (bombs.size !== 5) { //TODO !!!!!!!!! change 5 for a variable ... 
                let rowNr = Math.floor(Math.random() * rows) + 1
                let colNr = Math.floor(Math.random() * cols) + 1
                bombs.add(`${rowNr} - ${colNr}`)
            }
            
            bombs.forEach( el => { //Add a bomb to each randomized bomb location
                arr = el.split(" - ")
                row = document.querySelector(".row-" + arr[0])
                col = row.querySelector(".col-" + arr[1])
                
                col.firstChild.textContent = "B" //REPLACE WITH ICON
            })
        }
        
        function setup() {
            
            game.innerHTML = "" // clear content
            
            createGrid()
            insertBombs()


        }

        setup()
        
    </script>
</body>

</html>